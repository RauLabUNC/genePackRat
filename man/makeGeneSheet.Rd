% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coreFunctions.R
\name{makeGeneSheet}
\alias{makeGeneSheet}
\title{Generate Gene Sheet from locusPackRat Project}
\usage{
makeGeneSheet(
  filter_expr = NULL,
  highlight_genes = NULL,
  highlight_expr = NULL,
  highlight_color = "#FFFF99",
  summary_level = c("gene", "locus"),
  output_file = NULL,
  format = c("excel", "csv"),
  split_by = c("none", "chromosome", "criteria"),
  split_criteria = NULL,
  include_supplementary = TRUE,
  exclude_tables = NULL,
  collapse_multiples = TRUE,
  prefix_mode = c("collision", "abbreviated", "always"),
  project_dir = ".",
  format_numbers = TRUE,
  format_pvalues = TRUE,
  format_coordinates = TRUE,
  include_summary = TRUE,
  header_color = "#4472C4",
  min_col_width = 10,
  merge_repeated = FALSE
)
}
\arguments{
\item{filter_expr}{Character: Expression to filter genes (uses data.table syntax, e.g., "chr == 1 & start > 1000000")}

\item{highlight_genes}{Character vector: Gene symbols to highlight}

\item{highlight_expr}{Character: Expression to determine which genes to highlight}

\item{highlight_color}{Character: Background color for highlighted genes (hex color)}

\item{summary_level}{Character: "gene" for one row per gene, "locus" for one row per locus/region}

\item{output_file}{Character: Output file path (defaults to .locusPackRat/output/gene_sheet.csv or .xlsx)}

\item{format}{Character: "csv" for plain CSV, "excel" for formatted Excel workbook}

\item{split_by}{Character: For Excel, how to split into tabs - "none", "chromosome", "criteria"}

\item{split_criteria}{Named list: For split_by="criteria", list of tab_name = filter_expression}

\item{include_supplementary}{Logical or character vector: TRUE to include all supplementary tables,
FALSE for none, or character vector of specific table names to include}

\item{exclude_tables}{Character vector: Names of supplementary tables to exclude from output}

\item{collapse_multiples}{Logical: when merging supplementary tables,
collapse multiple matches per key into a single row by aggregating
values (e.g. concatenating text). If FALSE, keep all matches as
separate rows.}

\item{prefix_mode}{Character: How to handle column name prefixing from supplementary tables.
"collision" (default) only prefixes columns that would overwrite existing ones.
"abbreviated" prefixes all columns from tables that have an abbreviation set.
"always" prefixes all columns, using table_name as fallback if no abbreviation.}

\item{project_dir}{Character: Path to project directory containing .locusPackRat}

\item{format_numbers}{Logical: Auto-detect and format numeric columns (default TRUE)}

\item{format_pvalues}{Logical: Apply scientific notation to p-value columns (default TRUE)}

\item{format_coordinates}{Logical: Apply thousands separator to coordinate columns (default TRUE)}

\item{include_summary}{Logical: Add a summary sheet with workbook metadata (default TRUE)}

\item{header_color}{Character: Hex color for header background (default "#4472C4" - Excel blue)}

\item{min_col_width}{Numeric: Minimum column width in characters (default 10)}

\item{merge_repeated}{Logical: Merge consecutive cells with same gene_symbol in Phenotypes_Detail sheet (default FALSE)}
}
\value{
data.table of the gene sheet (invisible)
}
\description{
Creates formatted gene sheets (CSV or Excel) from project data with optional filtering and highlighting
}
