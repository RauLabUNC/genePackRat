% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filterGenes.R
\name{filterGenes}
\alias{filterGenes}
\title{Filter data using relational joins and flexible criteria}
\usage{
filterGenes(
  inputTable,
  referenceTable = NULL,
  by = NULL,
  filters = NULL,
  joinType = "inner",
  keepColumns = NULL,
  verbose = FALSE
)
}
\arguments{
\item{inputTable}{Data frame or data.table to filter}

\item{referenceTable}{Optional reference table to join for filtering}

\item{by}{Column(s) to join on. Can be:
- A character vector of column names (used for both tables)
- A named vector (names for inputTable, values for referenceTable)
- NULL to auto-detect common column names}

\item{filters}{Optional list of filter criteria to apply after joining. Each can be:
- A list with 'column', 'condition', and 'value'
- A function that takes the data and returns a logical vector
- A character expression string}

\item{joinType}{Type of join if referenceTable provided: "inner", "left", "semi", "anti"
- "inner": Keep only rows with matches in reference
- "left": Keep all input rows, add reference columns
- "semi": Keep input rows with matches (no reference columns added)
- "anti": Keep input rows WITHOUT matches}

\item{keepColumns}{Columns to retain in output (NULL = all columns)}

\item{verbose}{Print progress and statistics}
}
\value{
Filtered data frame/table
}
\description{
Filter any data frame/table using relational joins with reference tables
and/or custom filter criteria. This function provides a flexible way to
filter genes (or any data) based on relationships with other tables.
}
\details{
This function operates in two modes:

1. **Relational filtering**: When a referenceTable is provided, filter based on
   relationships between tables (e.g., "keep genes that appear in this list")

2. **Direct filtering**: When only filters are provided, apply them directly
   to the input table

These modes can be combined - first join with reference, then apply filters.
}
\examples{
# Example 1: Filter genes by a reference list (e.g., expressed genes)
allGenes <- data.frame(
  gene_symbol = c("Abc1", "Def2", "Ghi3", "Jkl4"),
  expression = c(10, 50, 200, 0)
)

expressedGenes <- data.frame(gene_symbol = c("Abc1", "Def2", "Ghi3"))

filtered <- filterGenes(
  inputTable = allGenes,
  referenceTable = expressedGenes,
  by = "gene_symbol",
  joinType = "semi"  # Keep only genes in the expressed list
)

# Example 2: Anti-join to exclude genes
excludeList <- data.frame(gene = c("Def2", "Jkl4"))
filtered <- filterGenes(
  inputTable = allGenes,
  referenceTable = excludeList,
  by = c("gene_symbol" = "gene"),  # Different column names
  joinType = "anti"  # Exclude genes in the list
)

}
